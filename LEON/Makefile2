AS=sparc-rtems-as
CC=sparc-rtems-gcc
DUMP=sparc-rtems-objdump

CFLAGS = -g -c -O2 -mv8 -mno-fpu -msoft-float 
#ASFLAGS = -D -gstabs 
LDFLAGS = -g -N -Ttext=40000000 #-nostdlib -nodefaultlibs -nostdinclude #-e main 
LIBS= -LD:/cygwin/opt/rtems/sparc-rtems/lib -lgcc -lm
DUMPFLAGS = -a -f -x -d -S -s -t

OBJS = InfoNES_System_LEON.o InfoNES_Mapper.o K6502.o InfoNES_pAPU.o InfoNES.o

all: $(OBJS)
	$(CC) $(OBJS) $(LDFLAGS) -o InfoNES.elf

sd: all
	${DUMP} ${DUMPFLAGS} InfoNES.elf > InfoNES.sd
	sparc-rtems-size InfoNES.elf

bin: all
	sparc-rtems-objcopy -O binary InfoNES.elf InfoNES.bin
	sparc-rtems-size InfoNES.elf

rebuild: clean all

clean:
	rm -f *.o
	rm -f *.elf
	rm -f *.sd
	rm -f *.bin
	
InfoNES_System_LEON.o:
	$(CC) -c $(CFLAGS) InfoNES_System_LEON.cpp -o InfoNES_System_LEON.o

InfoNES_Mapper.o:
	$(CC) -c $(CFLAGS) ../InfoNES_Mapper.cpp -o InfoNES_Mapper.o

K6502.o:
	$(CC) -c $(CFLAGS) ../K6502.cpp -o K6502.o

InfoNES_pAPU.o:
	$(CC) -c $(CFLAGS) ../InfoNES_pAPU.cpp -o InfoNES_pAPU.o

InfoNES.o:
	$(CC) -c $(CFLAGS) ../InfoNES.cpp -o InfoNES.o